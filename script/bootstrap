#!/bin/bash
########################
# Purpose: install the necessary project dependencies and create working environment
# Author: Prasad Talasila
# Date: 10-April-2017
# Invocation: This script does not require any arguements. From the project top-level
#             directory, invoke as follows
#             $bash script/bootstrap
########################

set -e      # bail out on failure

if [ -f "$ASDF_HOME/.asdf/completions/asdf.bash" ]
then
    echo "asdf already installed"
else
    git clone https://github.com/asdf-vm/asdf.git "$ASDF_HOME/.asdf" --branch v0.3.0
    . "$ASDF_HOME/.asdf/asdf.sh"
    . "$ASDF_HOME/.asdf/completions/asdf.bash"
fi

if [ -f "$ASDF_HOME/.asdf/installs/erlang/20.0/bin/erl" ]
then
    echo "erlang already installed"
else
    asdf plugin-add erlang https://github.com/asdf-vm/asdf-erlang.git
    asdf list-all erlang
    asdf install erlang 20.0
    asdf list erlang
    asdf global erlang 20.0
fi
asdf global erlang 20.0

if [ -f /home/vagrant/.asdf/installs/elixir/1.5.1/bin/elixir ]
then
    echo "elixir already installed"
else
    asdf plugin-add elixir https://github.com/asdf-vm/asdf-elixir.git
    asdf list-all elixir
    asdf install elixir 1.5.1
    asdf list elixir
    asdf global elixir 1.5.1
fi
asdf global elixir 1.5.1
